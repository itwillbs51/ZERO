<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.itwillbs.zero.mapper.AuctionMapper">
	
	<!-- 입찰 예정 목록 조회 - SELECT -->
	<!-- 카테고리별, 정렬별 조회 -->
	<select id="selectPreAuctionList" resultType="Hashmap">
		SELECT 
			auction_idx
			, brand_name
			, auction_title
			, auction_manage_check_date
			, auction_start_date
			, auction_start_price
			, auction_max_price
			, category_idx
			, auction_log_count
			FROM 
				AUCTION_PREPARE_LIST
					
			<!-- 1. 카테고리별 or 정렬별 조회할 WHERE 절, ORDER BY 절 수행, 아니면 생략 -->
			<if test="!category.equals('')"> <!-- !searchKeyword.equals('') == searchKeyword neq '' -->
			<!-- 2. 카테고리(category_idx)에 따른 WHERE 절 조건 대상 변경 -->
				<choose>
					<when test="category.equals('럭셔리')">
						AND category_idx = 6
					</when>
					<when test="category.equals('테크')">
						AND category_idx = 7
					</when>
					<when test="category.equals('한정판')">
						AND category_idx = 8
					</when>
				</choose>
			</if>
			
			<if test="!sort.equals('')"> <!-- !searchKeyword.equals('') == searchKeyword neq '' -->
				ORDER BY -- 정렬순
				<choose>
					<when test="sort.equals('인기순')">
						auction_log_count DESC
					</when>
					<when test="sort.equals('가격순')">
						auction_start_price DESC
					</when>
					<when test="sort.equals('최신순')">
						auction_manage_check_date DESC
					</when>
				</choose>
			</if>
				LIMIT 
					#{startRow} 
					, #{listLimit}
				
	</select>
	
	<select id="selectGetAuctionListCount" resultType="int">
		SELECT
			COUNT(*)
			FROM
				AUCTION_PREPARE_LIST
				
			<if test="!category.equals('')"> <!-- !searchKeyword.equals('') == searchKeyword neq '' -->
			
			<!-- 2. 카테고리(category_idx)에 따른 WHERE 절 조건 대상 변경 -->
				<choose>
					<when test="category.equals('럭셔리')">
						WHERE category_idx = 6
					</when>
					<when test="category.equals('테크')">
						WHERE category_idx = 7
					</when>
					<when test="category.equals('한정판')">
						WHERE category_idx = 8
					</when>
				</choose>
			</if>
	</select>
	
	
</mapper>
